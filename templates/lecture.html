<!DOCTYPE html>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script>
        async function fetchJSON(url, method, data) {
            try {
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        "Content-Type": "application/json",
                        "username": localStorage.getItem("username"),
                        "token": localStorage.getItem("token")
                    },
                    body: JSON.stringify(data),
                });

                return await response.json();
            } catch (error) {
                // error olunca browser'ın konsolunda göreceksin
                console.error("Error:", error);
            }
        }

        $(document).ready(function () {
            $("#btnLogin").click(async function () {
                let loginResponse = await fetchJSON(
                    "/api/login",
                    "POST",
                    {
                        "username": $("#usr").val(),
                        "password": $("#psw").val()
                    });

                localStorage.setItem("username", loginResponse.data.username)
                localStorage.setItem("token", loginResponse.data.token.String)
            });
        });
    </script>
</head>

<body>

    <div style="width: 100%;">
        {% if userExist %}
            {% for lecture in lectures %}
            <div id={{ lecture.ID }} class="lecture">
                <h3>Lecture {{ lecture.ID }}:</h3>
                <b>Code: {{ lecture.Code }}</b><br>
                <b>Name: {{ lecture.Name }}</b><br>
                <button id="btnLec{{lecture.ID}}">Take lecture</button><br>
            </div>
            {% endfor %}
        {% endif %}
        <br><br><br>
        <button id="getLectures">List lectures</buton>
    </div>

</body>

</html>